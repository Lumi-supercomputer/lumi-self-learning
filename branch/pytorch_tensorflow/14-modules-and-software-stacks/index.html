<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Environment Modules &mdash; Introduction to LUMI</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sphinx_lesson.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sphinx_rtd_theme_ext_color_contrast.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/overrides.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/minipres.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Introduction to LUMI
              <img src="../_static/LUMI_light.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quick-reference/">Quick Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Introduction to LUMI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Environment Modules</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/Lumi-supercomputer/content/blob/main/content/14-modules-and-software-stacks.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>On a high-performance computing system, it is seldom the case that the software
we want to use is available when we log in. It is installed, but we will need
to “load” it before it can run.</p>
<p>Before we start using individual software packages, however, we should
understand the reasoning behind this approach. The three biggest factors are:</p>
<ul class="simple">
<li><p>software incompatibilities</p></li>
<li><p>versioning</p></li>
<li><p>dependencies</p></li>
</ul>
<p>Software incompatibility is a major headache for programmers. Sometimes the
presence (or absence) of a software package will break others that depend on
it. Two of the most famous examples are Python 2 and 3 and C compiler versions.
Python 3 famously provides a <code class="docutils literal notranslate"><span class="pre">python</span></code> command that conflicts with that provided
by Python 2. Software compiled against a newer version of the C libraries and
then used when they are not present will result in a nasty <code class="docutils literal notranslate"><span class="pre">'GLIBCXX_3.4.20'</span> <span class="pre">not</span> <span class="pre">found</span></code> error, for instance.</p>
<p>Software versioning is another common issue. A team might depend on a certain
package version for their research project - if the software version was to
change (for instance, if a package was updated), it might affect their results.
Having access to multiple software versions allow a set of researchers to
prevent software versioning issues from affecting their results.</p>
<p>Dependencies are where a particular software package (or even a particular
version) depends on having access to another software package (or even a
particular version of another software package). For example, the VASP
materials science software may depend on having a particular version of the
FFTW (Fastest Fourier Transform in the West) software library available for it
to work.</p>
<section id="environment-modules">
<h1>Environment Modules<a class="headerlink" href="#environment-modules" title="Permalink to this heading"></a></h1>
<p>Environment modules are the solution to these problems. A <em>module</em> is a
self-contained description of a software package – it contains the
settings required to run a software package and, usually, encodes required
dependencies on other software packages.</p>
<p>There are a number of different environment module implementations commonly
used on HPC systems: the two most common are <em>TCL modules</em> and <em>Lmod</em>. Both of
these use similar syntax and the concepts are the same so learning to use one
will allow you to use whichever is installed on the system you are using. In
both implementations the <code class="docutils literal notranslate"><span class="pre">module</span></code> command is used to interact with environment
modules. An additional subcommand is usually added to the command to specify
what you want to do. For a list of subcommands you can use <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">-h</span></code> or
<code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">help</span></code>. As for all commands, you can access the full help on the <em>man</em>
pages with <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">module</span></code>.</p>
<p>On login you may start out with a default set of modules loaded or you may
start out with an empty environment; this depends on the setup of the system
you are using.</p>
<section id="listing-available-modules">
<h2>Listing Available Modules<a class="headerlink" href="#listing-available-modules" title="Permalink to this heading"></a></h2>
<p>To see available software modules, use <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">avail</span></code>:</p>
<p>{% include {{ site.snippets }}/modules/available-modules.snip %}</p>
</section>
<section id="listing-currently-loaded-modules">
<h2>Listing Currently Loaded Modules<a class="headerlink" href="#listing-currently-loaded-modules" title="Permalink to this heading"></a></h2>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">list</span></code> command to see which modules you currently have
loaded in your environment. If you have no modules loaded, you will see a
message telling you so</p>
</section>
</section>
<section id="loading-and-unloading-software">
<h1>Loading and Unloading Software<a class="headerlink" href="#loading-and-unloading-software" title="Permalink to this heading"></a></h1>
<p>To load a software module, use <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span></code>. In this example we will use
Python 3.</p>
<p>Initially, Python 3 is not loaded. We can test this by using the <code class="docutils literal notranslate"><span class="pre">which</span></code>
command. <code class="docutils literal notranslate"><span class="pre">which</span></code> looks for programs the same way that Bash does, so we can use
it to tell us where a particular piece of software is stored.</p>
<p>{% include {{ site.snippets }}/modules/missing-python.snip %}</p>
<p>We can load the <code class="docutils literal notranslate"><span class="pre">python3</span></code> command with <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span></code>:</p>
<p>{% include {{ site.snippets }}/modules/module-load-python.snip %}</p>
<p>{% include {{ site.snippets }}/modules/python-executable-dir.snip %}</p>
<p>So, what just happened?</p>
<p>To understand the output, first we need to understand the nature of the <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>
environment variable. <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> is a special environment variable that controls
where a UNIX system looks for software. Specifically <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> is a list of
directories (separated by <code class="docutils literal notranslate"><span class="pre">:</span></code>) that the OS searches through for a command
before giving up and telling us it can’t find it. As with all environment
variables we can print it out using <code class="docutils literal notranslate"><span class="pre">echo</span></code>.</p>
<p>{% include {{ site.snippets }}/modules/python-module-path.snip %}</p>
<p>You’ll notice a similarity to the output of the <code class="docutils literal notranslate"><span class="pre">which</span></code> command. In this case,
there’s only one difference: the different directory at the beginning. When we
ran the <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span></code> command, it added a directory to the beginning of our
<code class="docutils literal notranslate"><span class="pre">$PATH</span></code>. Let’s examine what’s there:</p>
<p>{% include {{ site.snippets }}/modules/python-ls-dir-command.snip %}</p>
<p>{% include {{ site.snippets }}/modules/python-ls-dir-output.snip %}</p>
<p>Taking this to its conclusion, <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span></code> will add software to your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>.
It “loads” software. A special note on this - depending on which version of the
<code class="docutils literal notranslate"><span class="pre">module</span></code> program that is installed at your site, <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span></code> will also load
required software dependencies.</p>
<p>{% include {{ site.snippets }}/modules/software-dependencies.snip %}</p>
<p>Note that this module loading process happens principally through
the manipulation of environment variables like <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>. There
is usually little or no data transfer involved.</p>
<p>The module loading process manipulates other special environment
variables as well, including variables that influence where the
system looks for software libraries, and sometimes variables which
tell commercial software packages where to find license servers.</p>
<p>The module command also restores these shell environment variables
to their previous state when a module is unloaded.</p>
</section>
<section id="software-versioning">
<h1>Software Versioning<a class="headerlink" href="#software-versioning" title="Permalink to this heading"></a></h1>
<p>So far, we’ve learned how to load and unload software packages. This is very
useful. However, we have not yet addressed the issue of software versioning. At
some point or other, you will run into issues where only one particular version
of some software will be suitable. Perhaps a key bugfix only happened in a
certain version, or version X broke compatibility with a file format you use.
In either of these example cases, it helps to be very specific about what
software is loaded.</p>
<p>Let’s examine the output of <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">avail</span></code> more closely.</p>
<p>{% include {{ site.snippets }}/modules/available-modules.snip %}</p>
<p>{% include {{ site.snippets }}/modules/wrong-gcc-version.snip %}</p>
<div class="admonition-using-software-modules-in-scripts exercise important admonition" id="exercise-0">
<p class="admonition-title">Using Software Modules in Scripts</p>
<p>Create a job that is able to run <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">--version</span></code>. Remember, no software
is loaded by default! Running a job is just like logging on to the system
(you should not assume a module loaded on the login node is loaded on a
compute node).</p>
<blockquote>
<div><p class="rubric">Solution</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">site</span><span class="o">.</span><span class="n">remote</span><span class="o">.</span><span class="n">prompt</span> <span class="p">}}</span> <span class="n">nano</span> <span class="n">python</span><span class="o">-</span><span class="n">module</span><span class="o">.</span><span class="n">sh</span>
<span class="p">{{</span> <span class="n">site</span><span class="o">.</span><span class="n">remote</span><span class="o">.</span><span class="n">prompt</span> <span class="p">}}</span> <span class="n">cat</span> <span class="n">python</span><span class="o">-</span><span class="n">module</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>{: .language-bash}</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">site</span><span class="o">.</span><span class="n">remote</span><span class="o">.</span><span class="n">bash_shebang</span> <span class="p">}}</span>

<span class="n">module</span> <span class="n">load</span> <span class="p">{{</span> <span class="n">site</span><span class="o">.</span><span class="n">remote</span><span class="o">.</span><span class="n">module_python3</span> <span class="p">}}</span>

<span class="n">python3</span> <span class="o">--</span><span class="n">version</span>
</pre></div>
</div>
<p>{: .output}</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{{</span> <span class="n">site</span><span class="o">.</span><span class="n">remote</span><span class="o">.</span><span class="n">prompt</span> <span class="p">}}</span> <span class="p">{{</span> <span class="n">site</span><span class="o">.</span><span class="n">sched</span><span class="o">.</span><span class="n">submit</span><span class="o">.</span><span class="n">name</span> <span class="p">}}</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">site</span><span class="o">.</span><span class="n">sched</span><span class="o">.</span><span class="n">submit</span><span class="o">.</span><span class="n">options</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="o">%</span><span class="p">}{{</span> <span class="n">site</span><span class="o">.</span><span class="n">sched</span><span class="o">.</span><span class="n">submit</span><span class="o">.</span><span class="n">options</span> <span class="p">}}</span> <span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span><span class="n">python</span><span class="o">-</span><span class="n">module</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>{: .language-bash}
{: .solution}</p>
</div></blockquote>
</div>
<p>{% include links.md %}</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>